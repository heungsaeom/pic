#include <REGX51.H>
sfr quetlop=0xA0;
sfr dieukhien=0xB0;
sfr dulieu=0x90; 
unsigned char i,a,b,c,d;

void delay(unsigned int time)
	{
	unsigned int i;
	for(i=0;i<=time;i++);
	}
	//////////////////
	void delay_quet(int t)							//delay
{int i;
unsigned char b;
for (i=0;i<t;i++){for(b=0;b<125;b++){;}}
}
///////
void xoa()
{
quetlop=0x00;
dieukhien=0xff;
dulieu=0x00;
delay_quet(5);
}
void delay_s(unsigned int time)
{unsigned char a;
	for(a=0;a<time;a++)
	{
		TMOD=0x01;
		TH0=0x3c;
		TL0=0x60;
		TR0=1;
		while(!TF0);
		TR0=TF0=0;
	}
}
////////////////
void sanghet()
{
dulieu=0xff;
quetlop=0xff;
dieukhien=0x00;
delay_s(60);
}
///////////////
void tathet()
{
xoa();
delay_s(20);
}
////////////
unsigned char mangtestlop[8]={0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80};
void testlop()
{ 	xoa();
	delay_s(10);
	for(i=0;i<8;i++)
	{
	dieukhien=0x00;
	dulieu=0xff;
	quetlop=mangtestlop[i];
	delay_s(10);
	xoa();
	delay(10);
	}
	for(i=0;i<8;i++)
	{
	dieukhien=0x00;
	dulieu=0xff;
	quetlop=mangtestlop[7-i];
	delay_s(10);
	xoa();
	delay(10);
}

}
//////////////////////////
unsigned char mangtesthang[8]={0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80};
void testhang()
{
xoa();
delay_s(10);
for(i=0;i<8;i++)
{
quetlop=0xff;
dieukhien=mangtesthang[i];
dulieu=0xff;
}
xoa();
delay_s(10);
for(i=0;i<8;i++)
{
quetlop=0xff;
dieukhien=mangtesthang[7-i];
dulieu=0xff;
}
}
///////////////
unsigned char mangtestcot[8]={0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80};
unsigned char mangdktestcot[8]={0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80};
void testcot()
{
//hang1
for(a=0;a<8;a++)
{	
	for(i=0;i<8;i++)
	{
	xoa();
	quetlop=0xff;
	dulieu=mangtestcot[i];
	dieukhien=~mangdktestcot[a];
	delay_s(5);
	xoa();
	delay(10);
}
}
}
////////////
unsigned char chonic[8]={0xFE,0xFD,0xFB,0xF7,0xEF,0xDF,0xBF,0x7F};
unsigned char mangtesttungled[8]={0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80};
unsigned char chonlop[8]={0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80};
void testtungled()
{
for(b=0;b<8;b++)
{
for(i=0;i<8;i++)
{
	for(a=0;a<8;a++)
	{
		quetlop=chonlop[b];
		dulieu=mangtesttungled[a];
		dieukhien=chonic[i];
		delay_s(10);
		xoa();
		delay(20);
	}
	}
	}

}
///////////
void test_mang()
{ 
	for(i=0;i<8;i++)
	{
		quetlop=0xff;
		dulieu=0xff;;
		dieukhien=chonic[i];
		delay_s(10);
		xoa();
		delay(20);
	}
}

//////////////////
void song_ngang2(int lap,int toc_do)
{  unsigned char n,y,z;
unsigned char code ma[12][64]={
   {0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,
0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,
0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,
},
   {0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,
0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,
0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,
0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,
},
   {0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x12,0x12,0x12,0x12,0x12,0x12,0x12,0x12,
0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,
0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,
0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
},
   {0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,
0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,
0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
},
   {0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x48,0x48,0x48,0x48,0x48,0x48,0x48,0x48,
0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,
0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,
0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
},
   {0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,
0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,
0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
},
   {0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,
0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,
0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,
},
   {0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,
0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,
0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,
0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x09,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,
},
   {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,
0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,
0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,0x21,
0x12,0x12,0x12,0x12,0x12,0x12,0x12,0x12,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,
},
   {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,0x81,
0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,
0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,
},
   {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,
0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,
0x48,0x48,0x48,0x48,0x48,0x48,0x48,0x48,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,
},
   {0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,
0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,
0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,
},
};
for(a=0;a<lap;a++)
{
    for(n=0;n<12;n++)       //trangthai
    {
    for(i=0;i<toc_do;i++)    //to do
    {
      for(z=0;z<8;z++)
      {
         for(y=0;y<8;y++)
         {
            dulieu=ma[n][8*z+y];
            dieukhien=chonic[y];
         }
		 quetlop=chonlop[z];
		 delay_quet(2);
         dulieu=quetlop=0x00;  
		           
      }
      
  }
}
}
}	
//////////////
void main()
{
while(1)
{
sanghet();
xoa();
tathet();
xoa();
testlop();
xoa();
test_mang();
xoa();														
testcot();
xoa();
testtungled();
xoa();
}
}




